<!DOCTYPE html>
<html>
  <head>
    <title>Organization Management</title>
    <!-- Link to Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" />
    <style>
      /* Additional custom styles for the page */
      .container {
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
      }

      /* Sidebar styles */
      .sidebar {
        height: 100%;
        width: 200px;
        position: fixed;
        top: 0;
        left: 0;
        background-color: #f0f0f0;
        padding-top: 20px;
      }

      .sidebar a {
        display: block;
        padding: 10px 20px;
        color: #333;
        text-decoration: none;
      }

      .sidebar a:hover {
        background-color: #ddd;
      }

      /* Style for the table */
.table {
    border-collapse: separate;
    border-spacing: 0 0.5rem;
}

.table th {
    background-color: #f5f5f5;
}

.table td, .table th {
    vertical-align: middle;
}

/* Style for the dropdown and button */
.status-dropdown {
    display: inline-block;
    vertical-align: middle;
}

.update-status-btn {
    vertical-align: middle;
}

.btn-link {
    padding-left: 0;
    padding-right: 0;
}

    </style>
  </head>
  <body>
    <!-- Sidebar -->
    <div class="sidebar">
      <a href="/admin/dashboard">Dashboard</a>
      <a href="/admin/organizationmanagement">Organization Management</a> 
      <a href="/admin/droppointmanagement">Drop Point Management</a> 
      <a href="/admin/managermanagement">Manager Management</a>
      <a href="/admin/usermanagement">User Management</a>
    </div>

    <!-- Main content -->
    <div class="main-content ml-200">
      <div class="container">
        <h1>Organization Management</h1>
        <!-- Tabs for filtering organizations -->
        <ul class="nav nav-tabs">
          <li class="nav-item">
            <a class="nav-link <%= selectedStatus === 'PENDING' ? 'active' : '' %>" data-toggle="tab" href="#pending">Pending</a>
          </li>
          <li class="nav-item">
            <a class="nav-link <%= selectedStatus === 'APPROVED' ? 'active' : '' %>" data-toggle="tab" href="#approved">Approved</a>
          </li>
          <li class="nav-item">
            <a class="nav-link <%= selectedStatus === 'REJECTED' ? 'active' : '' %>" data-toggle="tab" href="#rejected">Rejected</a>
          </li>
        </ul>
        
        <!-- Tab panes for organization lists -->
        <div class="tab-content">
          <div class="tab-pane fade <%= selectedStatus === 'PENDING' ? 'show active' : '' %>" id="pending">
            <!-- Organizations for Pending status -->
            <table class="table">
              <thead>
                <tr>
                  <th>Organization Name</th>
                  <th>Business Email</th>
                  <th>Company Address</th>
                  <th>Contact Number</th>
                  <th>Secondary Registration Number</th>
                  <th>Organization Type</th>
                  <th>Documents</th>
                  <th colspan="2">Verification Action</th> <!-- Renamed for clarity -->
                </tr>
              </thead>              
              <tbody>
                <% organizations.forEach((organization) => { %>
                  <% if (organization.verificationStatus === 'PENDING') { %>
                    <tr>
                      <td><%= organization.organizationname %></td>
                      <td><%= organization.email %></td>
                      <td><%= organization.address %></td>
                      <td><%= organization.contactNumber %></td>
                      <td><%= organization.secRegistrationNumber || 'N/A' %></td>
                      <td><%= organization.type %></td>
                      
                      <!-- Link to view documents -->
                      <td>
                        <a href="/admin/viewdocuments?organizationId=<%= organization.id %>" class="btn btn-link btn-sm" target="_blank">View</a>
                      </td>
              
                      <form action="/admin/updateOrganizationStatus" method="post">
                        <td>
                          <select class="form-control status-dropdown" name="newStatus" style="width: auto;">
                            <option value="PENDING" <%= organization.verificationStatus === 'PENDING' ? 'selected' : '' %>>Pending</option>
                            <option value="APPROVED" <%= organization.verificationStatus === 'APPROVED' ? 'selected' : '' %>>Approve</option>
                            <option value="REJECTED" <%= organization.verificationStatus === 'REJECTED' ? 'selected' : '' %>>Reject</option>
                        </select>                        
                        </td>
                    
                        <!-- Hidden input to send the organization ID -->
                        <input type="hidden" name="organizationId" value="<%= organization.id %>">
                        <!-- Hidden input to send the current selected status -->
                        <input type="hidden" name="selectedStatus" value="<%= selectedStatus %>">
                    
                        <!-- Button to submit the form -->
                        <td>
                            <button type="submit" class="btn btn-primary btn-sm">Update</button>
                        </td>
                    </form>                    
                    </tr>
                  <% } %>
                <% }); %>
              </tbody>
              
            </table>
          </div>
          <div class="tab-pane fade <%= selectedStatus === 'APPROVED' ? 'show active' : '' %>" id="approved">
            <!-- Organizations for Approved status -->
            <table class="table">
              <thead>
                <tr>
                  <th>Organization Name</th>
                  <th>Business Email</th>
                  <th>Company Address</th>
                  <th>Contact Number</th>
                  <th>SEC Registration Number</th>
                  <th>Organization Type</th> 
                  <th>Documents</th>
                </tr>
              </thead>
              <tbody>
                <% organizations.forEach((organization) => { %>
                  <% if (organization.verificationStatus === 'APPROVED') { %>
                    <tr>
                      <td><%= organization.organizationname %></td>
                      <td><%= organization.email %></td>
                      <td><%= organization.address %></td>
                      <td><%= organization.contactNumber %></td>
                      <td><%= organization.secRegistrationNumber || 'N/A' %></td>
                      <td><%= organization.type %></td> 
                      <!-- Link to view documents -->
                      <td>
                        <a href="/admin/viewdocuments?organizationId=<%= organization.id %>" class="btn btn-link btn-sm" target="_blank">View Documents</a>
                      </td>
                    </tr>
                  <% } %>
                <% }); %>
              </tbody>
            </table>
          </div> 
          <div class="tab-pane fade <%= selectedStatus === 'REJECTED' ? 'show active' : '' %>" id="rejected">
            <!-- Organizations for Rejected status -->
            <table class="table">
              <thead>
                <tr>
                  <th>Organization Name</th>
                  <th>Business Email</th>
                  <th>Company Address</th>
                  <th>Contact Number</th>
                  <th>SEC Registration Number</th>
                  <th>Organization Type</th> 
                  <th>Documents</th>
                </tr>
              </thead>
              <tbody>
                <% organizations.forEach((organization) => { %>
                  <% if (organization.verificationStatus === 'REJECTED') { %>
                    <tr>
                      <td><%= organization.organizationname %></td>
                      <td><%= organization.email %></td>
                      <td><%= organization.address %></td>
                      <td><%= organization.contactNumber %></td>
                      <td><%= organization.secRegistrationNumber || 'N/A' %></td>
                      <td><%= organization.type %></td> 
                      <!-- Link to view documents -->
                      <td>
                        <a href="/admin/viewdocuments?organizationId=<%= organization.id %>" class="btn btn-link btn-sm" target="_blank">View Documents</a>
                      </td>
                    </tr>
                  <% } %>
                <% }); %>
              </tbody>
            </table>
          </div>
          
        </div>
      </div> 
    </div>

    <!-- Load Bootstrap JS (you can also include jQuery for additional functionality) -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.1/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

    <!-- Add your JavaScript code here to fetch and populate organization lists based on tabs -->
    
  </body>
</html>
